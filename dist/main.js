(()=>{"use strict";const e=class{constructor(e,t){this._name=e,this._length=t,this._hits=0}get name(){return this._name}get length(){return this._length}get hits(){return this._hits}hit(){this._hits++}isSunk(){return this.hits>=this.length}},t=class{constructor(e){this.name=e,this.board=this.#e(),this.cells=this.#t(),this.ships={},this.misses=[]}placeShip(e,t){if(!this.#s(e,t))return!1;for(let s=0;s<t.length;s++){this.cells[e].classList.add(t.name,"taken"),this.cells[e].dataset.shipName=t.name;let[s,a]=this.#a(e);e=String.fromCharCode(s.charCodeAt()+1)+a}return this.ships[t.name]=t,!0}placeShipsRandomly(){const t=[new e("carrier",5),new e("battleship",4),new e("destroyer",3),new e("submarine",3),new e("patrol",2)];for(let e=0;e<t.length;e++){let s=Math.floor(Math.random()*this.cellCoordinates().length),a=this.cellCoordinates()[s];this.#s(a,t[e])?this.placeShip(a,t[e]):e--}}receiveAttack(e){const t=this.cells[e];if(t.className.includes("taken")){let s=t.dataset.shipName;return this.ships[s].hit(),this.cells[e].classList.add("hit"),!0}return this.misses.push(e),this.cells[e].classList.add("miss"),!1}allSunk(){return Object.entries(this.ships).every((([e,t])=>t.isSunk()))}cellCoordinates(){return Object.keys(this.cells)}#e(){const e=document.createElement("div");e.classList.add(this.name,"board");for(let t=1;t<11;t++)for(let s=0;s<10;s++){const a=this.#i(t,s);e.appendChild(this.#r(a))}return e}#s(e,t){return this.#n(e,t)&&this.#l(e,t)}#n(e,t){const s=e[0];return"ABCDEFGHIJ".indexOf(s)+t.length<=10}#l(e,t){for(let s=0;s<t.length;s++){if(this.cells[e].className.includes("taken"))return!1;let[t,s]=this.#a(e);e=String.fromCharCode(t.charCodeAt()+1)+s}return!0}#a(e){const[t,s,a]=e.match(/([A-J])(\d+)/);return[s,a]}#i(e,t){return"ABCDEFGHIJ"[t]+e}#r(e){const t=document.createElement("div");return t.classList.add("cell"),t.dataset.coordinate=e,t}#t(){return[...this.board.children].reduce(((e,t)=>(e[t.dataset.coordinate]=t,e)),{})}},s=class{constructor(e){this.type=e,this.availableMoves=this.#o()}convertPlayerMove(e){return e.target.dataset.coordinate}getMove(){const e=this.#c(),t=this.availableMoves[e];return this.#h(t),t}#h(e){const t=this.availableMoves.indexOf(e);this.availableMoves.splice(t,1)}#c(){return Math.floor(Math.random()*this.availableMoves.length)}#o(){return(new t).cellCoordinates()}},a=(()=>{const e=document.querySelector(".boards-container");return{displayBoard:t=>{e.appendChild(t.board)}}})();(()=>{const e=new s("human"),i=new s("ai");let r="human";const n=new t("player-board"),l=new t("ai-board");function o(){if("ai"===r){const e=i.getMove(),t=n.receiveAttack(e);if(console.log(n.allSunk(),"player"),!t)return void(r="human");o()}}a.displayBoard(n),a.displayBoard(l),Array.from(l.board.childNodes).forEach((t=>{t.addEventListener("click",(t=>{!function(t){if(t&&"human"===r){const s=e.convertPlayerMove(t);l.receiveAttack(s)||(r="ai",o()),console.log(l.allSunk(),"ai")}}(t)}))})),n.placeShipsRandomly(),l.placeShipsRandomly(),console.log(l)})()})();