(()=>{"use strict";const e=class{constructor(e){this.name=e,this.board=this.#e(),this.cells=this.#t(),this.ships={},this.misses=[]}placeShip(e,t){if(!this.#s(e,t))return!1;for(let s=0;s<t.length;s++){this.cells[e].classList.add(t.name,"taken"),this.cells[e].dataset.shipName=t.name;let[s,a]=e.split("");e=String.fromCharCode(s.charCodeAt()+1)+a}return this.ships[t.name]=t,!0}receiveAttack(e){const t=this.cells[e];if(t.className.includes("taken")){let s=t.dataset.shipName;return this.ships[s].hit(),this.cells[e].classList.add("hit"),!0}return this.misses.push(e),this.cells[e].classList.add("miss"),!1}allSunk(){return Object.entries(this.ships).every((([e,t])=>t.isSunk()))}#e(){const e=document.createElement("div");e.classList.add(this.name,"board");for(let t=1;t<11;t++)for(let s=0;s<10;s++){const a=this.#a(t,s);e.appendChild(this.#i(a))}return e}#s(e,t){const s=e[0];return"ABCDEFGHIJ".indexOf(s)+t.length<=10}#a(e,t){return"ABCDEFGHIJ"[t]+e}#i(e){const t=document.createElement("div");return t.classList.add("cell"),t.dataset.coordinate=e,t}#t(){return[...this.board.children].reduce(((e,t)=>(e[t.dataset.coordinate]=t,e)),{})}},t=class{constructor(e){this.type=e,this.availableMoves=this.#r()}convertPlayerMove(e){return e.target.dataset.coordinate}getMove(){const e=this.#n(),t=this.availableMoves[e];return this.#l(t),t}#l(e){const t=this.availableMoves.indexOf(e);this.availableMoves.splice(t,1)}#n(){return Math.floor(Math.random()*this.availableMoves.length)}#r(){return Object.keys((new e).cells)}},s=(()=>{const e=document.querySelector(".boards-container");return{displayBoard:t=>{e.appendChild(t.board)}}})(),a=s,i=class{constructor(e,t){this._name=e,this._length=t,this._hits=0}get name(){return this._name}get length(){return this._length}get hits(){return this._hits}hit(){this._hits++}isSunk(){return this.hits>=this.length}};(()=>{const s=new t("human"),r=new t("ai");let n="human";const l=new e("player-board"),c=new e("ai-board");a.displayBoard(l),a.displayBoard(c),Array.from(c.board.childNodes).forEach((e=>{e.addEventListener("click",(e=>{!function(e){if(e&&"human"===n){const t=s.convertPlayerMove(e);c.receiveAttack(t)||(n="ai",f()),console.log(c.allSunk(),"ai")}}(e)}))}));const o=new i("carrier",5),h=new i("battleship",4),d=new i("destroyer",3),p=new i("submarine",3),u=new i("patrol",2);l.placeShip("H1",o),l.placeShip("C3",h),l.placeShip("D5",d),l.placeShip("B7",p),l.placeShip("G9",u);const m=new i("carrier",5),v=new i("battleship",4),b=new i("destroyer",3),g=new i("submarine",3),S=new i("patrol",2);function f(){if("ai"===n){const e=r.getMove(),t=l.receiveAttack(e);if(console.log(l.allSunk(),"player"),!t)return void(n="human");f()}}c.placeShip("A2",m),c.placeShip("C3",v),c.placeShip("D5",b),c.placeShip("B7",g),c.placeShip("G9",S)})()})();